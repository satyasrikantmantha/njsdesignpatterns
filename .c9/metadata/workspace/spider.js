{"filter":false,"title":"spider.js","tooltip":"/spider.js","undoManager":{"mark":8,"position":8,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":4,"column":39},"action":"insert","lines":["var request = require('request');","var fs = require('fs');","var mkdirp = require('mkdirp');","var path = require('path');","var utilities = require('./utilities');"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":39},"end":{"row":5,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":5,"column":0},"end":{"row":6,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":0},"end":{"row":7,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":0},"end":{"row":35,"column":1},"action":"insert","lines":["function spider(url, callback) {"," var filename = utilities.urlToFilename(url);"," fs.exists(filename, function(exists) { //[1]"," if(!exists) {"," console.log(\"Downloading \" + url);"," request(url, function(err, response, body) { //[2]"," if(err) {"," callback(err);"," } else {"," mkdirp(path.dirname(filename), function(err) { //[3]"," if(err) {"," callback(err);"," } else {"," fs.writeFile(filename, body, function(err) { //[4]"," if(err) {"," callback(err);"," } else {"," callback(null, filename, true);"," }"," });"," }"," });"," }"," });"," } else {"," callback(null, filename, false);"," }"," });","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":35,"column":1},"end":{"row":36,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":37,"column":0},"end":{"row":45,"column":3},"action":"insert","lines":["spider(process.argv[2], function(err, filename, downloaded) {"," if(err) {"," console.log(err);"," } else if(downloaded){"," console.log('Completed the download of \"'+ filename +'\"');"," } else {"," console.log('\"'+ filename +'\" was already downloaded');"," }","});"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":0},"end":{"row":7,"column":0},"action":"remove","lines":["",""]},{"start":{"row":7,"column":0},"end":{"row":7,"column":1},"action":"insert","lines":[" "]},{"start":{"row":8,"column":0},"end":{"row":8,"column":1},"action":"insert","lines":[" "]},{"start":{"row":8,"column":40},"end":{"row":9,"column":0},"action":"remove","lines":[" //[1]",""]},{"start":{"row":8,"column":40},"end":{"row":9,"column":3},"action":"insert","lines":["","   "]},{"start":{"row":10,"column":0},"end":{"row":10,"column":5},"action":"insert","lines":["     "]},{"start":{"row":11,"column":0},"end":{"row":11,"column":5},"action":"insert","lines":["     "]},{"start":{"row":11,"column":50},"end":{"row":12,"column":0},"action":"remove","lines":[" //[2]",""]},{"start":{"row":11,"column":50},"end":{"row":12,"column":7},"action":"insert","lines":["","       "]},{"start":{"row":13,"column":0},"end":{"row":13,"column":9},"action":"insert","lines":["         "]},{"start":{"row":14,"column":0},"end":{"row":14,"column":7},"action":"insert","lines":["       "]},{"start":{"row":15,"column":0},"end":{"row":15,"column":9},"action":"insert","lines":["         "]},{"start":{"row":15,"column":56},"end":{"row":29,"column":0},"action":"remove","lines":[" //[3]"," if(err) {"," callback(err);"," } else {"," fs.writeFile(filename, body, function(err) { //[4]"," if(err) {"," callback(err);"," } else {"," callback(null, filename, true);"," }"," });"," }"," });"," }",""]},{"start":{"row":15,"column":56},"end":{"row":29,"column":5},"action":"insert","lines":["","            if(err) {","              callback(err);","            } else {","              fs.writeFile(filename, body, function(err) {","                if(err) {","                  callback(err);","                } else {","                  callback(null, filename, true);","                }","              });","            }","          });","        }","     "]},{"start":{"row":30,"column":0},"end":{"row":30,"column":3},"action":"insert","lines":["   "]},{"start":{"row":31,"column":0},"end":{"row":31,"column":5},"action":"insert","lines":["     "]},{"start":{"row":32,"column":0},"end":{"row":32,"column":3},"action":"insert","lines":["   "]},{"start":{"row":33,"column":0},"end":{"row":33,"column":1},"action":"insert","lines":[" "]},{"start":{"row":33,"column":5},"end":{"row":33,"column":6},"action":"insert","lines":[" "]},{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"insert","lines":["",""]},{"start":{"row":38,"column":0},"end":{"row":38,"column":1},"action":"insert","lines":[" "]},{"start":{"row":39,"column":0},"end":{"row":39,"column":3},"action":"insert","lines":["   "]},{"start":{"row":40,"column":0},"end":{"row":40,"column":1},"action":"insert","lines":[" "]},{"start":{"row":41,"column":0},"end":{"row":41,"column":3},"action":"insert","lines":["   "]},{"start":{"row":42,"column":0},"end":{"row":42,"column":1},"action":"insert","lines":[" "]},{"start":{"row":43,"column":0},"end":{"row":43,"column":3},"action":"insert","lines":["   "]},{"start":{"row":44,"column":0},"end":{"row":44,"column":1},"action":"insert","lines":[" "]},{"start":{"row":45,"column":3},"end":{"row":47,"column":0},"action":"insert","lines":["","",""]}]}]]},"ace":{"folds":[],"scrolltop":240,"scrollleft":0,"selection":{"start":{"row":40,"column":24},"end":{"row":40,"column":24},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1426556354000,"hash":"dffcba0541f603aa9fa105285c71b2b5f1f3ba91"}